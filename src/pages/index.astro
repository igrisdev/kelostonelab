---
import BeforeAndAfter from '@sections/home/BeforeAndAfter.astro'
import Layout from '@layouts/Layout.astro'
import PromoProducts from '@sections/home/PromoProducts.astro'
import ProductCollections from '@sections/home/ProductCollections.astro'
import FeaturedProducts from '@sections/home/FeaturedProducts.astro'
import FeaturedProduct from '@sections/home/FeaturedProduct.astro'
import Header from '@sections/home/Header.astro'

import { client } from '@services/connectionShopify'

const productsQuery = `
  query ProductsQuery($first: Int) {
    products(first: $first) {
      edges {
        node {
          id
          title
          description
          handle
          images(first: 1) {
            edges {
              node {
                originalSrc
              }
            }
          }
        }
      }
    }
  }
`

async function getProducts(first = 10) {
  try {
    const { data, errors, extensions } = await client.request(productsQuery, {
      variables: {
        first, // Número de productos que deseas obtener
      },
    })

    if (errors) {
      console.error('Errores en la consulta:', errors)
    } else {
      console.log('Productos obtenidos:', data.products.edges)
    }
  } catch (error) {
    console.error('Error ejecutando la consulta:', error)
  }
}

getProducts(10) // Cambia el número según lo que necesites
---

<Layout>
  <Header />
  <BeforeAndAfter />
  <PromoProducts />
  <ProductCollections />
  <FeaturedProducts />
  <FeaturedProduct />
</Layout>
